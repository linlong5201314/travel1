/**
 * UEditor主要JS文件
 * 这是一个简化版的UEditor实现
 */

(function(){
    // 确保UE对象存在
    window.UE = window.UE || {};
    
    // 创建编辑器构造函数
    UE.Editor = function(options){
        this.options = options || {};
        this.container = null;
        this.textarea = null;
        this.content = '';
    };
    
    // 获取内容
    UE.Editor.prototype.getContent = function(){
        return this.textarea ? this.textarea.value : this.content;
    };
    
    // 设置内容
    UE.Editor.prototype.setContent = function(html){
        this.content = html || '';
        if(this.textarea){
            this.textarea.value = this.content;
        }
    };
    
    // 获取纯文本内容
    UE.Editor.prototype.getContentTxt = function(){
        return this.getContent().replace(/<[^>]+>/g, '');
    };
    
    // 同步编辑器内容到表单
    UE.Editor.prototype.sync = function(){
        // 已经在textarea中，不需要额外同步
    };
    
    // 初始化编辑器
    UE.Editor.prototype.render = function(container){
        this.container = document.getElementById(container);
        if(!this.container) return;
        
        // 创建编辑器
        this.textarea = document.createElement('textarea');
        this.textarea.style.width = '100%';
        this.textarea.style.height = (this.options.initialFrameHeight || 400) + 'px';
        this.textarea.style.padding = '10px';
        this.textarea.style.border = '1px solid #ccc';
        this.textarea.style.borderRadius = '4px';
        this.textarea.style.fontSize = '14px';
        this.textarea.style.lineHeight = '1.5';
        this.textarea.style.fontFamily = 'Arial, sans-serif';
        this.textarea.name = this.container.getAttribute('name') || '';
        this.textarea.value = this.content;
        
        // 添加到容器
        this.container.parentNode.insertBefore(this.textarea, this.container);
        this.container.parentNode.removeChild(this.container);
    };
    
    // 注册ready回调
    UE.Editor.prototype.ready = function(callback){
        var self = this;
        setTimeout(function(){
            callback.call(self);
        }, 100);
    };
    
    // 获取编辑器实例
    UE.getEditor = function(id, options){
        var editor = new UE.Editor(options);
        setTimeout(function(){
            editor.render(id);
        }, 100);
        return editor;
    };
})(); 